#Spot

Spot is a lightweight model framework designed for Swift structs. You design your model layer entities using Xcode's Core Data model design tool. Code is then generated automatically.The framework provides serialization using Plists, XML Plists, or JSON.

If you need a simple lightweight solution, you've come to the right... *Spot*.

####The Key Points: 

- Support for immutable, optional, and non-optional properties
- Design  model entities using Xcode's data model designer
- Use enums for model entities (design enums directly in the model designer)
- Automatically generate model code
- No heavy model layer subclassing
- Extend your model entities with Swift extensions generated for you
- Make fast changes and additions to your model layer
- Plist and JSON serialization is lightweight and modular

##tl;dr:
### Design your model layer in Xcode's data model tool:
 <img src="https://cloud.githubusercontent.com/assets/84623/7208746/e8ff0658-e510-11e4-9327-1fad64ab9a93.png">

### Swift struct model code is generated automatically:
This code is generated by Spot using it's custom mogenerator templates. 


 ```swift
import Spot

/************************************************
            MACHINE GENERATED FILE
 ************************************************/

public struct Issue {
	let product: Product
    var comment: String?
    var title: String
    var assignee: Developer
    
    var status: IssueStatus?
    var type: IssueType

    init(comment: String?, title: String, assignee: Developer, product: Product, status: IssueStatus?, type: IssueType) {

        self.comment = comment
        self.title = title
        self.assignee = assignee
        self.product = product
        self.status = status
        self.type = type

    }
}

extension Issue : Decodable {

    static func create(comment: String?)(title: String)(assignee: Developer)(product: Product)(status: IssueStatus?)(type: IssueType) -> Issue  {

        return Issue(comment: comment, title: title, assignee: assignee, product: product, status: status, type: type)
    }

    public init?(decoder: Decoder) {
        let instance: Issue? = Issue.create
        <^> decoder.decodeOptional("comment")
        <*> decoder.decode("title")
        <*> decoder.decodeObject("assignee")
        <*> decoder.decodeObject("product")
        <*> decoder.decodeOptionalObject("status")
        <*> decoder.decodeObject("type")

        if let i = instance { self = i } else { return nil }
    }
}

extension Issue : Encodable {

    public func encode(encoder: Encoder) {
        encoder.encode(self.comment, forKey: "comment")
        encoder.encode(self.title, forKey: "title")
        encoder.encode(self.assignee, forKey: "assignee")
        encoder.encode(self.product, forKey: "product")
        encoder.encode(self.status, forKey: "status")
        encoder.encode(self.type, forKey: "type")

    }
}
```
### Write models to JSON (or .plists):

```swift
JSON.write(Encoder.encode(issues), path: documentPathFor("issues.json"))
```



```json
"openIssues" : [
    {
      "product" : {
        "name" : "iSpot Pro"
      },
      "comment" : "write more tests",
      "assignee" : {
        "name" : "Spiff Johnson"
      },
      "status" : {
        "value" : 1
      },
      "type" : {
        "value" : "task"
      },
      "title" : "New Issue"
    },
```

### Read models from JSON  (or .plists).
```swift
let loadedIssues: Issues? = Decoder.decode(JSON.read(documentPathFor("issues.json")))
```

-
##Getting Started

- Adding Spot to your project
- Installing Mogenerator command line tool

### Set-up a target to automatically generate model code every time you build your product.

If you do not have Spot framework, or mogenerator installed do that first. 
 
1. In your Xcode project, select `file > new > target`, and under OS X select other. Choose "External Build System" and click next.

2. give your target a name such as "GenerateModels" and hit finish.

3. select your project in the project navigator and select the new target you just added

4. under the info tab for the target set up the "External Build Tool Configuration" as follows:

	#####Build Tool: `/usr/local/bin/mogenerator`  
	(or where ever mogenerator is installed. (type `which mogenerator` in terminal to 	find the location)
	

	#####Arguments:
	--model `<path to your .xcdatamodeld file>` --swift --template-path `<path to spots template folder>` --output-dir `<path to save model code files>`

	#####example: 
If spot is installed in a subdirectory of your project, and you had a models folder for your models, it would look something like this: --model $(SRCROOT)/ProjectName/Models/Model.xcdatamodeld --swift --template-path $(SRCROOT)/../Spot/Templates --output-dir $(SRCROOT)/ProjectName/Models/

5. Select the target that you want to use the model entities in, and select `Build Phases` and twist open the `Target Dependencies` section at the top. 

6. Click the plus to add a dependency and select the GenerateModels target you just created earlier. 
	This will tell Xcode to build your GenerateModels target before building the host target.
	
7. The first time you generate the code files you will have to manually add them to the project.

You should now be able to add entities to the data modeler, and the code files should generate each time you build. If not, check the issue or report navigator to investigate the cause.





##System Requirements
- Swift 1.2
- Xcode 6.3
- iOS 8.0
- Mogenerator 

-

## Data Modeler:
Enter these keys and values into the user-info section of the data modeler inspector window to apply the options.

### Entity Key-Value Reference
| Key                              | Description                | Values            |
| -------------------------------- | -------------------------- | :----------------:|
| `Spot.Enum` | Specify entity is an enum. All attributes are considered cases of the enum. Specify raw value type with `STModel.Type` . *required for enums. | `YES`, `NO` |
| `Spot.Type`       | Raw value type for  enum. *required for enums.| The exact name of the type to use as the raw value type for the enum entity.  |

### Attribute Key-Value Reference
| Key                              | Description                | Values            |
| -------------------------------- | -------------------------- | :----------------:|
| `Spot.Immutable`    | Specify an attribute is immutable (code will use `let` instead of `var` for the property) | `YES`, `NO` |
| `Spot.Type`       | The type of the attribute. Useful for specifying a custom type for an attribute. (select "undefined" in the inspector windwo when using this option)| The exact name of the type to use for entity.  |
| `Spot.Value`	| The raw value of the enum case. used when entity is an enum. each attribute is considered a case of the enum. the value specified is the raw value of the current case. *required for enums. | The exact value of the case. (strings must be in quotes)

### Transformables:
Set an attribute type as transformable in the data modeler, and enter a value transformer name. The value transformer name entered must be of a type that implements Spot's ValueTransform protocol. Spot will automatically use the transform type to transform the attribute when encoding and decoding the element.

### Optionals:
Select the optional check box for an attribute in the data modeler inspector window and the attribute will be implemented as an optional.

### Data Modeler Notes:

- You must enter a class name for entities or no code will be generated for that entity.
- Int16, Int32 or Int64 are all currently implemented as Int.
- If you enter a custom type using Spot.Type, remember to select "undefined" as the type in the attribute option type.
- Do not link the .xcdatamodel file to your target
- When adding or renaming entities in your model, remember that you may need to copy the new generated files in to your project. (re-naming entities generates new files).


